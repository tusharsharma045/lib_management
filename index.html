<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library Management System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- NAVBAR -->
    <nav class="navbar">
        <div class="navbar-brand">
            <span class="navbar-logo">&#128218;</span>
            <span class="navbar-title">LibManager</span>
        </div>
        <div class="navbar-search">
            <input type="text" id="globalSearch" placeholder="Search books, authors..." oninput="handleGlobalSearch(this.value)">
        </div>
    </nav>

    <!-- LAYOUT -->
    <div class="app-layout">

        <!-- SIDEBAR -->
        <aside class="sidebar">
            <ul class="menu">
                <li class="menu-label">MAIN</li>
                <li class="menu-item active" data-section="dashboard" onclick="navigate('dashboard', this)">
                    <span class="menu-icon">&#128202;</span> Dashboard
                </li>
                <li class="menu-item" data-section="allBooks" onclick="navigate('allBooks', this)">
                    <span class="menu-icon">&#128214;</span> All Books
                </li>
                <li class="menu-item" data-section="assignedBooks" onclick="navigate('assignedBooks', this)">
                    <span class="menu-icon">&#128203;</span> Assigned
                </li>
                <li class="menu-label">MANAGE</li>
                <li class="menu-item" data-section="addBook" onclick="navigate('addBook', this)">
                    <span class="menu-icon">&#10133;</span> Add Book
                </li>
                <li class="menu-item" data-section="mostIssued" onclick="navigate('mostIssued', this)">
                    <span class="menu-icon">&#128293;</span> Most Issued
                </li>
                <li class="menu-item" data-section="history" onclick="navigate('history', this)">
                    <span class="menu-icon">&#128336;</span> History
                </li>
                <li class="menu-label">TOOLS</li>
                <li class="menu-item" data-section="searchBooks" onclick="navigate('searchBooks', this)">
                    <span class="menu-icon">&#128269;</span> Search
                </li>
            </ul>
        </aside>

        <!-- CONTENT -->
        <main class="content">
            <div id="alert" class="alert"></div>

            <!-- DASHBOARD -->
            <section id="dashboard" class="page active">
                <h2 class="page-title">&#128202; Dashboard</h2>
                <div class="stats-grid">
                    <div class="stat-card stat-total">
                        <div class="stat-number" id="statTotal">0</div>
                        <div class="stat-label">Total Books</div>
                    </div>
                    <div class="stat-card stat-available">
                        <div class="stat-number" id="statAvailable">0</div>
                        <div class="stat-label">Available</div>
                    </div>
                    <div class="stat-card stat-assigned">
                        <div class="stat-number" id="statAssigned">0</div>
                        <div class="stat-label">Assigned</div>
                    </div>
                    <div class="stat-card stat-issues">
                        <div class="stat-number" id="statTotalIssues">0</div>
                        <div class="stat-label">Total Issues</div>
                    </div>
                </div>
                <div class="dashboard-panels">
                    <div class="panel">
                        <h3>&#128293; Top Issued Books</h3>
                        <div id="dashTopIssued"></div>
                    </div>
                    <div class="panel">
                        <h3>&#128203; Currently Assigned</h3>
                        <div id="dashCurrentAssigned"></div>
                    </div>
                </div>
            </section>

            <!-- ALL BOOKS -->
            <section id="allBooks" class="page">
                <h2 class="page-title">&#128214; All Books</h2>
                <p class="page-desc">Select a category to browse books</p>

                <!-- Category cards (generated dynamically by JS) -->
                <div id="categoryView" class="category-grid"></div>

                <!-- Books table (hidden until a category is clicked) -->
                <div id="booksTableView" style="display: none;">
                    <button class="btn btn-back" onclick="showCategoryView()">&#8592; Back</button>
                    <h3 id="categoryHeading" class="category-heading"></h3>
                    <div class="toolbar">
                        <select id="filterStatus" onchange="renderAllBooks()">
                            <option value="all">All Status</option>
                            <option value="available">Available Only</option>
                            <option value="assigned">Assigned Only</option>
                        </select>
                        <select id="sortBooks" onchange="renderAllBooks()">
                            <option value="id">Sort by ID</option>
                            <option value="title">Sort by Title</option>
                            <option value="author">Sort by Author</option>
                        </select>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th><th>Title</th><th>Author</th><th>Genre</th><th>Status</th><th>Issues</th><th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="bookList"></tbody>
                    </table>
                </div>
            </section>

            <!-- ASSIGNED BOOKS -->
            <section id="assignedBooks" class="page">
                <h2 class="page-title">&#128203; Assigned Books</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th><th>Title</th><th>Assigned To</th><th>Assigned On</th><th>Duration</th><th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="assignedList"></tbody>
                </table>
            </section>

            <!-- ADD BOOK -->
            <section id="addBook" class="page">
                <h2 class="page-title">&#10133; Add New Book</h2>
                <form class="add-form" onsubmit="addBook(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Book Title</label>
                            <input id="inputTitle" required placeholder="Enter book title">
                        </div>
                        <div class="form-group">
                            <label>Author Name</label>
                            <input id="inputAuthor" required placeholder="Enter author name">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Genre</label>
                        <select id="inputGenre" required>
                            <option value="">Select genre</option>
                            <option value="Programming">Programming</option>
                            <option value="Web Development">Web Development</option>
                            <option value="Data Science">Data Science</option>
                            <option value="Database">Database</option>
                            <option value="DevOps">DevOps</option>
                            <option value="Design">Design</option>
                            <option value="Fiction">Fiction</option>
                            <option value="Science">Science</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">&#10133; Add Book</button>
                </form>
            </section>

            <!-- MOST ISSUED -->
            <section id="mostIssued" class="page">
                <h2 class="page-title">&#128293; Most Issued Books</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Rank</th><th>Title</th><th>Author</th><th>Genre</th><th>Times Issued</th><th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="mostIssuedList"></tbody>
                </table>
            </section>

            <!-- HISTORY -->
            <section id="history" class="page">
                <h2 class="page-title">&#128336; Issue History</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>#</th><th>Book</th><th>User</th><th>Action</th><th>Date &amp; Time</th>
                        </tr>
                    </thead>
                    <tbody id="historyList"></tbody>
                </table>
            </section>

            <!-- SEARCH -->
            <section id="searchBooks" class="page">
                <h2 class="page-title">&#128269; Search Books</h2>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Type title, author or genre..." oninput="performSearch()">
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th><th>Title</th><th>Author</th><th>Genre</th><th>Status</th><th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="searchResults"></tbody>
                </table>
            </section>

        </main>
    </div>

    <!-- ASSIGN MODAL -->
    <div id="modal" class="modal">
        <div class="modal-box">
            <div class="modal-header">
                <h3>&#128203; Assign Book</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <p id="modalTitle" class="modal-subtitle"></p>
            <div class="form-group">
                <label>Borrower Name</label>
                <input id="userName" required placeholder="Enter borrower's name">
            </div>
            <div class="modal-actions">
                <button class="btn btn-success" onclick="confirmAssign()">Assign</button>
                <button class="btn btn-danger" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
