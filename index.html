<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library Management System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- TOP NAVBAR -->
    <nav class="navbar">
        <div class="navbar-brand">
            <span class="navbar-logo">&#128218;</span>
            <span class="navbar-title">LibManager</span>
        </div>
        <div class="navbar-search">
            <input type="text" id="globalSearch" placeholder="Search books, authors..." oninput="handleGlobalSearch(this.value)">
        </div>
        <div class="navbar-info">
            <span id="clockDisplay"></span>
            <span class="navbar-user">&#128100; Admin</span>
        </div>
    </nav>

    <!-- MAIN LAYOUT -->
    <div class="app-layout">

        <!-- SIDEBAR MENU -->
        <aside class="sidebar">
            <ul class="menu">
                <li class="menu-label">MAIN</li>
                <li class="menu-item active" data-section="dashboard" onclick="navigate('dashboard', this)">
                    <span class="menu-icon">&#128202;</span> Dashboard
                </li>
                <li class="menu-item" data-section="allBooks" onclick="navigate('allBooks', this)">
                    <span class="menu-icon">&#128214;</span> View All Books
                </li>
                <li class="menu-item" data-section="assignedBooks" onclick="navigate('assignedBooks', this)">
                    <span class="menu-icon">&#128203;</span> Assigned Books
                </li>

                <li class="menu-label">MANAGE</li>
                <li class="menu-item" data-section="addBook" onclick="navigate('addBook', this)">
                    <span class="menu-icon">&#10133;</span> Add New Book
                </li>
                <li class="menu-item" data-section="mostIssued" onclick="navigate('mostIssued', this)">
                    <span class="menu-icon">&#128293;</span> Most Issued Books
                </li>
                <li class="menu-item" data-section="history" onclick="navigate('history', this)">
                    <span class="menu-icon">&#128336;</span> Issue History
                </li>

                <li class="menu-label">TOOLS</li>
                <li class="menu-item" data-section="searchBooks" onclick="navigate('searchBooks', this)">
                    <span class="menu-icon">&#128269;</span> Search &amp; Filter
                </li>
            </ul>
        </aside>

        <!-- CONTENT AREA -->
        <main class="content">
            <div id="alert" class="alert"></div>

            <!-- DASHBOARD -->
            <section id="dashboard" class="page active">
                <h2 class="page-title">&#128202; Dashboard</h2>
                <div class="stats-grid">
                    <div class="stat-card stat-total">
                        <div class="stat-number" id="statTotal">0</div>
                        <div class="stat-label">Total Books</div>
                    </div>
                    <div class="stat-card stat-available">
                        <div class="stat-number" id="statAvailable">0</div>
                        <div class="stat-label">Available</div>
                    </div>
                    <div class="stat-card stat-assigned">
                        <div class="stat-number" id="statAssigned">0</div>
                        <div class="stat-label">Assigned</div>
                    </div>
                    <div class="stat-card stat-issues">
                        <div class="stat-number" id="statTotalIssues">0</div>
                        <div class="stat-label">Total Issues</div>
                    </div>
                </div>
                <div class="dashboard-panels">
                    <div class="panel">
                        <h3>&#128293; Top Issued Books</h3>
                        <div id="dashTopIssued"></div>
                    </div>
                    <div class="panel">
                        <h3>&#128203; Currently Assigned</h3>
                        <div id="dashCurrentAssigned"></div>
                    </div>
                </div>
            </section>

            <!-- ALL BOOKS -->
            <section id="allBooks" class="page">
                <h2 class="page-title">&#128214; All Books</h2>
                <p class="page-desc">Select a category to browse books</p>

                <!-- Category Cards View -->
                <div id="categoryView" class="category-grid">
                    <div class="category-card card-all" onclick="openCategory('all')">
                        <span class="cat-icon">&#128218;</span>
                        <span class="cat-name">All Books</span>
                        <span class="cat-count" id="countAll">0</span>
                    </div>
                    <div class="category-card card-webdev" onclick="openCategory('Web Development')">
                        <span class="cat-icon">&#127760;</span>
                        <span class="cat-name">Web Development</span>
                        <span class="cat-count" id="countWebDev">0</span>
                    </div>
                    <div class="category-card card-ds" onclick="openCategory('Data Structures')">
                        <span class="cat-icon">&#128200;</span>
                        <span class="cat-name">Data Structures</span>
                        <span class="cat-count" id="countDS">0</span>
                    </div>
                    <div class="category-card card-mag" onclick="openCategory('Magazines')">
                        <span class="cat-icon">&#128240;</span>
                        <span class="cat-name">Magazines</span>
                        <span class="cat-count" id="countMag">0</span>
                    </div>
                    <div class="category-card card-prog" onclick="openCategory('Programming')">
                        <span class="cat-icon">&#128187;</span>
                        <span class="cat-name">Programming</span>
                        <span class="cat-count" id="countProg">0</span>
                    </div>
                    <div class="category-card card-datasci" onclick="openCategory('Data Science')">
                        <span class="cat-icon">&#129302;</span>
                        <span class="cat-name">Data Science</span>
                        <span class="cat-count" id="countDataSci">0</span>
                    </div>
                    <div class="category-card card-db" onclick="openCategory('Database')">
                        <span class="cat-icon">&#128451;</span>
                        <span class="cat-name">Database</span>
                        <span class="cat-count" id="countDB">0</span>
                    </div>
                    <div class="category-card card-devops" onclick="openCategory('DevOps')">
                        <span class="cat-icon">&#9881;</span>
                        <span class="cat-name">DevOps</span>
                        <span class="cat-count" id="countDevOps">0</span>
                    </div>
                    <div class="category-card card-design" onclick="openCategory('Design')">
                        <span class="cat-icon">&#127912;</span>
                        <span class="cat-name">Design</span>
                        <span class="cat-count" id="countDesign">0</span>
                    </div>
                    <div class="category-card card-fiction" onclick="openCategory('Fiction')">
                        <span class="cat-icon">&#128214;</span>
                        <span class="cat-name">Fiction</span>
                        <span class="cat-count" id="countFiction">0</span>
                    </div>
                    <div class="category-card card-science" onclick="openCategory('Science')">
                        <span class="cat-icon">&#128300;</span>
                        <span class="cat-name">Science</span>
                        <span class="cat-count" id="countScience">0</span>
                    </div>
                    <div class="category-card card-math" onclick="openCategory('Mathematics')">
                        <span class="cat-icon">&#128290;</span>
                        <span class="cat-name">Mathematics</span>
                        <span class="cat-count" id="countMath">0</span>
                    </div>
                </div>

                <!-- Books Table View (hidden initially) -->
                <div id="booksTableView" style="display: none;">
                    <button class="btn btn-back" onclick="backToCategories()">&#8592; Back to Categories</button>
                    <h3 id="categoryHeading" class="category-heading"></h3>
                    <div class="toolbar">
                        <select id="filterStatus" onchange="renderAllBooks()">
                            <option value="all">All Status</option>
                            <option value="available">Available Only</option>
                            <option value="assigned">Assigned Only</option>
                        </select>
                        <select id="filterGenre" onchange="renderAllBooks()">
                            <option value="all">All Genres</option>
                        </select>
                        <select id="sortBooks" onchange="renderAllBooks()">
                            <option value="id">Sort by ID</option>
                            <option value="title">Sort by Title</option>
                            <option value="author">Sort by Author</option>
                        </select>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th><th>Title</th><th>Author</th><th>Genre</th><th>Status</th><th>Issue Count</th><th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="bookList"></tbody>
                    </table>
                </div>
            </section>

            <!-- ASSIGNED BOOKS -->
            <section id="assignedBooks" class="page">
                <h2 class="page-title">&#128203; Assigned Books</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th><th>Title</th><th>Assigned To</th><th>Assigned On</th><th>Duration</th><th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="assignedList"></tbody>
                </table>
            </section>

            <!-- ADD BOOK -->
            <section id="addBook" class="page">
                <h2 class="page-title">&#10133; Add New Book</h2>
                <form class="add-form" onsubmit="addBook(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Book Title</label>
                            <input id="inputTitle" required placeholder="Enter book title">
                        </div>
                        <div class="form-group">
                            <label>Author Name</label>
                            <input id="inputAuthor" required placeholder="Enter author name">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Genre</label>
                            <select id="inputGenre" required>
                                <option value="">Select genre</option>
                                <option value="Programming">Programming</option>
                                <option value="Web Development">Web Development</option>
                                <option value="Data Science">Data Science</option>
                                <option value="Database">Database</option>
                                <option value="DevOps">DevOps</option>
                                <option value="Design">Design</option>
                                <option value="Data Structures">Data Structures</option>
                                <option value="Magazines">Magazines</option>
                                <option value="Fiction">Fiction</option>
                                <option value="Science">Science</option>
                                <option value="Mathematics">Mathematics</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ISBN (optional)</label>
                            <input id="inputISBN" placeholder="e.g. 978-3-16-148410-0">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">&#10133; Add Book</button>
                </form>
            </section>

            <!-- MOST ISSUED -->
            <section id="mostIssued" class="page">
                <h2 class="page-title">&#128293; Most Issued / Assigned Books</h2>
                <p class="page-desc">Books ranked by how many times they have been issued to readers.</p>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Rank</th><th>Title</th><th>Author</th><th>Genre</th><th>Times Issued</th><th>Current Status</th>
                        </tr>
                    </thead>
                    <tbody id="mostIssuedList"></tbody>
                </table>
            </section>

            <!-- ISSUE HISTORY -->
            <section id="history" class="page">
                <h2 class="page-title">&#128336; Issue History</h2>
                <p class="page-desc">Complete log of all book issue and return transactions.</p>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>#</th><th>Book</th><th>User</th><th>Action</th><th>Date &amp; Time</th>
                        </tr>
                    </thead>
                    <tbody id="historyList"></tbody>
                </table>
            </section>

            <!-- SEARCH & FILTER -->
            <section id="searchBooks" class="page">
                <h2 class="page-title">&#128269; Search &amp; Filter</h2>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Type book title, author or genre..." oninput="performSearch()">
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th><th>Title</th><th>Author</th><th>Genre</th><th>Status</th><th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="searchResults"></tbody>
                </table>
            </section>

        </main>
    </div>

    <!-- ASSIGN MODAL -->
    <div id="modal" class="modal">
        <div class="modal-box">
            <div class="modal-header">
                <h3>&#128203; Assign Book</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <p id="modalTitle" class="modal-subtitle"></p>
            <div class="form-group">
                <label>User Name</label>
                <input id="userName" required placeholder="Enter borrower's name">
            </div>
            <div class="modal-actions">
                <button class="btn btn-success" onclick="confirmAssign()">Assign Book</button>
                <button class="btn btn-danger" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
